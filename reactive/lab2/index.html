<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
  <title>Scala</title>
  <link rel="stylesheet" type="text/css" href="../style.css">
</head>

<body>
<table WIDTH="80%" HEIGHT="90%" BORDER="0" ALIGN=CENTER>
<tr>
<td ALIGN=CENTER>
<div ALIGN=left>
<hr>
<h2>Programowanie reaktywne w jezyku Scala</h2>
<hr>

<h3>Projektowanie systemu aktorów</h3>

<h3>Przyk³ady</h3>
<ul>
  <li>
    <pre>
git clone https://github.com/balis/reactive-lab2
    </pre>
    <p>
      Uruchomienie w konsoli:
    </p>
    <pre>
cd reactive-lab2
sbt "runMain reactive2.BankApp"
sbt "runMain reactive2.ToggleApp"
    </pre>

    <p>
      Uruchomienie w IntelliJ:
    </p>
    Po otwarciu projektu wybieramy "sbt shell" na dolnej belce i po uruchomieniu ¶rodowiska wpisujemy:
    <pre>
sbt "runMain reactive2.BankApp"
sbt "runMain reactive2.ToggleApp"
    </pre>
    Ewentualnie sposob prostszy: klikamy prawym przyciskiem myszy na
    <pre>object BankApp</pre>
    i wybieramy
    <pre>Run: BankApp</pre>

    <p></p>
    Konfiguracja logowania znajduje siê w pliku
    <a href="https://github.com/balis/reactive-lab2/blob/master/src/main/resources/application.conf">src/main/resources/application.conf</a>

    </p>
  </li>

  <li>
    Przyk³ad <a href=http://sdanzig.blogspot.com/2013/06/buddychat-simple-example-of-akka-actors.html>BuddyChat</a>
  </li>
  Zaktualizowana wersja znajduje siê tutaj: <a href="https://github.com/agh-reactive/buddychat">https://github.com/agh-reactive/buddychat</a>
  <p></p>
  Uruchomienie przyk³adu:

  <pre>
git clone https://github.com/agh-reactive/buddychat.git
cd buddychat
sbt run
  </pre>
</ul>


<h3>Maszyna stanów</h3>
<ul>
  <li>Notacja
  <p><IMG SRC="statechart-notation.png" width="600">
  <ul>
      <li>Event1, Event2 -- ka¿de ze zdarzeñ mo¿e inicjowaæ zmianê stanu</li>
      <li>[guard] -- warunek logiczny, który dodatkowo musi byæ spe³niony, ¿eby dosz³o do zmiany stanu</li>
   </ul>
  </li>
  <li><A HREF=http://doc.akka.io/docs/akka/current/scala/fsm.html>Akka FSM</A></li>
</ul>


<h3>Zadanie -- e-Sklep</h3>
Zadanie polega na zaimplementowaniu fragmentu systemu e-Sklepu z³o¿onego z nastêpuj±cych aktorów:
<ol>
  <li><B>Cart</B>: aktor reprezentuj±cy koszyk na zakupy, który ma dzia³aæ wed³ug nastêpuj±cej maszyny stanów:
    <p></p>
    <img SRC="cart.png" width="800"/>
  </li>
  <li>
    <B>Checkout</B>: aktor, który reprezentuje operacjê finalizacji zakupu, dzia³aj±cy wg nastêpuj±cej maszyny stanów:
  </li>
    <p></p>
  <img SRC="checkout.png" width="800" />
</ol>

Zadania do wykonania:
<ol>

  <li>(20 pkt) Proszê zaimplementowaæ aktorów <B>CartActor</B> i <B>Checkout</B>
    <ul>
      <li>Proszê zaprojektowaæ wiadomo¶ci jako Case Class'y. Proszê pamiêtaæ o rozró¿nieniu na wiadomo¶ci-komendy
        (np. <TT>AddItem(...)</TT>) i wiadomo¶ci-zdarzenia (np. <TT>ItemAdded(...)</TT>) (ewentualnie równie¿ wiadomo¶ci-dokumenty).
        Wiêcej <A HREF="http://www.informit.com/articles/article.aspx?p=2428369">tutaj</A>.
        <pre>
          case object Cart {
            sealed trait Command
            case class AddItem(id: String) extends Command
            ...
            sealed trait Event
            case class ItemAdded(id: String) extends Event
          }
        </pre>
      </li>
      <li>Do sterowania maszyn± stanów proszê wykorzystaæ standardowy mechanizm <TT>become</TT>.</li>
      <li>Proszê stworzyæ aplikacjê, która wykonuje prosty test stworzonych aktorów.</li>
      <li>Do implementacji limitów czasowych proszê wykorzystaæ mechanizm
        <A HREF=https://doc.akka.io/docs/akka/current/scala/actors.html#actors-timers>timerów</A> (do przeczytania równie¿ rozdzia³ o
        <A HREF=http://doc.akka.io/docs/akka/current/scala/scheduler.html>Schedulerach</A>). Aktor powinien zaplanowaæ wys³anie
        wiadomo¶ci do samego siebie oznaczaj±cej up³yniecie okre¶lonego terminu:
        <ul>
          <li>CartTimer: czas po jakim koszyk jest automatycznie opró¿niany.</li>
          <li>CheckoutTimer: czas po jakim rozpoczêta operacja finalizacji zakupu jest anulowana.</li>
          <li>PaymentTimer: maksymalny czas oczekiwania na zrealizowanie p³atno¶ci, po którym operacja zakupu jest anulowana.</li>
        </ul>
      </li>
    </ul>
  <p></p>
  </li>

  <li>(10 pkt) Proszê wykorzystaæ <A HREF=http://doc.akka.io/docs/akka/current/scala/fsm.html>Akka FSM</A> do implementacji maszyny stanów w Aktorze <B>CartActor</B>.

  <li>(10 pkt) Proszê wykorzystaæ <A HREF=http://doc.akka.io/docs/akka/current/scala/fsm.html>Akka FSM</A> do implementacji maszyny stanów w Aktorze <B>Checkout</B>.

</ol>

  <p>
    <b>
      Do implementacji powy¿szych zadañ mo¿na wykorzystaæ przygotowany szablon z pocz±tkowymi testami znajduj±cy siê tutaj:
      <a href="https://github.com/agh-reactive/reactive-scala-labs-templates">https://github.com/agh-reactive/reactive-scala-labs-templates</a>
    </b>
  </p>


  <p></p>
  <p></p>
  <hr>
  <i>Bartosz Bali¶, balis at agh edu pl</i>
  <br>
  <i>Maciej Malawski, malawski at agh edu pl</i>
  <br>
  <i>Katarzyna Rycerz, kzajac at agh edu pl</i>
  <br>
  <i>Krzysztof Borowski, kborowski at agh edu pl</i>
  <br>
  <p></p>

</div>
</td>
</tr>
</table>
</body>
</html>
